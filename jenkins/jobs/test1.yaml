- job:
    name: test1
    concurrent: true
    description: 'test'
    
    scm:
        - git:
            url: http://gerrit.digium.internal/r/test
            branches:
                - $GERRIT_BRANCH
            refspec: $GERRIT_REFSPEC
            choosing-strategy: gerrit
            skip-tag: true
            per-build-tag: false
            clean:
              before: true
              after: false
            wipe-workspace: false

    builders:
        - shell: |
            #!/bin/bash
            gcc -o test test.c
            
    triggers:
        - gerrit:
            server-name: "Gerrit Internal"
            trigger-on:
                - patchset-created-event:
                    exclude-drafts: true
                    exclude-trivial-rebase: true
                    exclude-no-code-change: true
            projects:
                - project-compare-type: 'PLAIN'
                  project-pattern: 'test'
                  branches:
                    - branch-compare-type: 'PLAIN'
                      branch-pattern: 'master'

- job:
    name: test2
    concurrent: true
    description: 'test on cr1'
    
    scm:
        - git:
            url: http://gerrit.digium.internal/r/test
            branches:
                - $GERRIT_BRANCH
            refspec: $GERRIT_REFSPEC
            choosing-strategy: gerrit
            skip-tag: true
            per-build-tag: false
            clean:
              before: true
              after: false
            wipe-workspace: false

    builders:
        - shell: |
            #!/bin/bash
            gcc -o test test.c
            
    triggers:
        - gerrit:
            server-name: "Gerrit Internal"
            trigger-on:
                - comment-added-event:
                    approval-category: 'CRVW'
                    approval-value: '+1'
            projects:
                - project-compare-type: 'PLAIN'
                  project-pattern: 'test'
                  branches:
                    - branch-compare-type: 'PLAIN'
                      branch-pattern: 'master'

- job:
    name: test3
    concurrent: true
    description: 'test on cr1'
    
    scm:
        - git:
            url: http://gerrit.digium.internal/r/test
            branches:
                - $GERRIT_BRANCH
            refspec: $GERRIT_REFSPEC
            choosing-strategy: gerrit
            skip-tag: true
            per-build-tag: false
            clean:
              before: true
              after: false
            wipe-workspace: false

    builders:
        - shell: |
            #!/bin/bash
            gcc -o test test.c
            
    triggers:
        - gerrit:
            server-name: "Gerrit Internal"
            trigger-on:
                - comment-added-event:
                    approval-category: 'CRVW'
                    approval-value: '+2'
            projects:
                - project-compare-type: 'PLAIN'
                  project-pattern: 'test'
                  branches:
                    - branch-compare-type: 'PLAIN'
                      branch-pattern: 'master'
